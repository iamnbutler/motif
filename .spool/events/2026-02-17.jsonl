{"v":1,"op":"reopen","id":"mln635v3-7dyl","ts":"2026-02-17T20:15:51.008782Z","by":"@iamnbutler","branch":"main","d":{}}
{"v":1,"op":"update","id":"mln635v3-7dyl","ts":"2026-02-17T20:15:51.042489Z","by":"@iamnbutler","branch":"main","d":{"description":"When rendering multiple quads via instancing, only some instances appear. \n\nROOT CAUSE FOUND: Metal's float3 has 16-byte alignment, but Rust's [f32; 3] has 4-byte alignment. This caused:\n- Rust QuadInstance: 112 bytes\n- Metal QuadInstance: 128 bytes (due to float3 padding alignment)\n- 16 byte mismatch per instance, causing Metal to read wrong offsets\n\nFIX: Changed Metal shader from 'float3 _padding' to three separate 'float _pad1, _pad2, _pad3' fields. Individual floats have 4-byte alignment matching Rust."}}
{"v":1,"op":"complete","id":"mln635v3-7dyl","ts":"2026-02-17T20:15:55.711583Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"create","id":"mlr1o70k-xovp","ts":"2026-02-17T20:17:14.372916Z","by":"@iamnbutler","branch":"main","d":{"description":"Write documentation explaining the Metal float3 alignment issue we encountered with instanced rendering.\n\n## Background\nWhen implementing GPU instancing for quad rendering, only some quads rendered despite correct data on the Rust side.\n\n## Root Cause\nMetal Shading Language has different alignment rules than Rust's #[repr(C)]:\n\n| Type | Size | Rust Alignment | Metal Alignment |\n|------|------|----------------|-----------------|\n| float | 4 | 4 | 4 |\n| float2 | 8 | 4 | 8 |\n| float3 | 12 | 4 | **16** |\n| float4 | 16 | 4 | 16 |\n\nThe key insight: float3 in Metal has 16-byte alignment (not 12\\!), while Rust's [f32; 3] has only 4-byte alignment.\n\nThis caused our QuadInstance struct to be:\n- Rust: 112 bytes\n- Metal: 128 bytes (extra padding before float3 field)\n\nWhen copying N instances, Metal read each instance at offset N*128, but data was at offset N*112, causing progressive drift.\n\n## Solution\nReplace `float3 _padding` with three separate `float` fields, which have 4-byte alignment in both languages.\n\n## Prevention\nWhen defining GPU structs shared between Rust and Metal:\n1. Avoid float3 in Metal (use float4 or separate floats)\n2. Add compile-time size assertions\n3. Consider using crates like bytemuck with explicit size checks\n\n## References\n- Apple Metal Shading Language Spec: Data Types section\n- Commit: 43e46ef","priority":"p3","stream":"mliupru8-vi36","tags":["docs"],"title":"Document Metal struct alignment gotcha"}}
{"v":1,"op":"create","id":"mlr1y6iq-s2eg","ts":"2026-02-17T20:25:00.290716Z","by":"@iamnbutler","branch":"main","d":{"description":"VoiceOver outlines appeared in wrong positions despite text being read correctly.\n\nROOT CAUSE: Accessibility bounds were being passed to AccessKit in logical coordinates, but AccessKit (via winit) expects physical pixel coordinates.\n\nFIX: Multiply accessibility bounds by scale factor before passing to AccessKit.\n\nCommit: (see fix: use physical pixel coordinates for accessibility bounds)","priority":"p2","stream":"mllpwi2y-uv1c","tags":["bug"],"title":"Bug: Accessibility bounds were in wrong coordinate system"}}
{"v":1,"op":"complete","id":"mlr1y6iq-s2eg","ts":"2026-02-17T20:25:06.110148Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"create","id":"mlr3gljl-dluh","ts":"2026-02-17T21:07:19.185557Z","by":"@iamnbutler","branch":"main","d":{"description":"Add smallvec crate to motif_core Cargo.toml for SmallVec<[AnyElement; 2]> in Div children.","priority":"p2","stream":"mllpgwt9-zoqg","title":"Add smallvec dependency"}}
{"v":1,"op":"create","id":"mlr3gn6m-vblv","ts":"2026-02-17T21:07:21.310440Z","by":"@iamnbutler","branch":"main","d":{"description":"Create SharedString enum (Static(&'static str) | Owned(Arc<str>)) with From impls, Display, Debug, Deref, etc. Follows GPUI's pattern for cheap-to-clone strings.","priority":"p2","stream":"mllpgwt9-zoqg","title":"Implement SharedString type"}}
{"v":1,"op":"create","id":"mlr3goj7-lv2t","ts":"2026-02-17T21:07:23.059831Z","by":"@iamnbutler","branch":"main","d":{"description":"Core trait definitions:\n- Element: low-level with layout() + paint() \n- IntoElement: conversion trait\n- Render: stateful views (&mut self)\n- RenderOnce: stateless elements (consumes self)\n- AnyElement: type-erased wrapper\n- WindowContext and ViewContext","priority":"p1","stream":"mllpgwt9-zoqg","title":"Define core element traits (Element, IntoElement, Render, RenderOnce)"}}
{"v":1,"op":"create","id":"mlr3gpf2-ovo0","ts":"2026-02-17T21:07:24.206840Z","by":"@iamnbutler","branch":"main","d":{"description":"Div element: bounds, background, border, corner_radius, children (SmallVec<[AnyElement; 2]>). Builder methods: .bounds(), .background(), .child(). Implements Element trait with layout+paint.","priority":"p2","stream":"mllpgwt9-zoqg","title":"Implement Div element with builder pattern"}}
{"v":1,"op":"create","id":"mlr3gqiy-qvwh","ts":"2026-02-17T21:07:25.642251Z","by":"@iamnbutler","branch":"main","d":{"description":"Text element using SharedString for content. Builder methods for position, font_size, color. Implements Element trait. IntoElement impls for &str, String, SharedString.","priority":"p2","stream":"mllpgwt9-zoqg","title":"Implement Text element"}}
{"v":1,"op":"create","id":"mlr3grom-m6yh","ts":"2026-02-17T21:07:27.142706Z","by":"@iamnbutler","branch":"main","d":{"description":"Example demonstrating: a stateful Render view (Counter), a stateless RenderOnce element (Button), rendering element tree to Scene, wired to Metal renderer.","priority":"p2","stream":"mllpgwt9-zoqg","title":"Create hello_element example"}}
{"v":1,"op":"complete","id":"mllpjtxm-znwq","ts":"2026-02-17T21:07:36.137824Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"complete","id":"mllpjv1u-c634","ts":"2026-02-17T21:07:36.174544Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"complete","id":"mlr3gljl-dluh","ts":"2026-02-17T21:09:52.658445Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"complete","id":"mlr3gn6m-vblv","ts":"2026-02-17T21:09:52.687710Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"complete","id":"mlr3goj7-lv2t","ts":"2026-02-17T21:09:52.711431Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"complete","id":"mlr3gpf2-ovo0","ts":"2026-02-17T21:09:52.742112Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"complete","id":"mlr3gqiy-qvwh","ts":"2026-02-17T21:09:52.765612Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
{"v":1,"op":"complete","id":"mlr3grom-m6yh","ts":"2026-02-17T21:11:32.912289Z","by":"@iamnbutler","branch":"main","d":{"resolution":"done"}}
